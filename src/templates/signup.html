{% extends 'base.html' %}

{% block title %} Create Workout | FitList {% endblock %}

{% block content %}
<script type="text/jsx">
class SignupForm extends React.Component {
    constructor(props) {
        super(props);
        this.state = {
            username: '',
            email: '',
            pass_plain: '',
            pass_conf: '',
        };
        this.handleChange = this.handleChange.bind(this);
        this.handleSubmit = this.handleSubmit.bind(this);
        this.pass_match = false;
        this.pass_req = false;
        this.can_submit = false;
    }

    handleChange(event) {
        const target = event.target;
        const value = target.value;
        const name = target.name;


        if(value.indexOf(' ') > -1) {
            return;
        }

        this.setState({
            [name]: value
        });

        
        if(this.state.pass_plain && this.state.pass_conf && this.state.email && this.state.username) {
            this.can_submit = true;
        } else {
            this.can_submit = false;
        }
    }

    handleSubmit(event) {
        event.preventDefault();
/*
        if(this.state.pass_plain != this.state.pass_conf) {
           this.pass_match = false;
           return;
        } else {
            this.pass_match = true;
        }
*/
        axios.post('user_created', {
            username: this.state.username,
            email: this.state.email,
            password: this.state.pass_plain
        })
        .then(function (response) {
            console.log(response);
        })
        .catch(function (error) {
            console.log(error);
        });
    }

    render() {
        return (
            <div>
            <form autocomplete="off" onSubmit={this.handleSubmit}>
                    Username 
                    <input type="text" name="username" value={this.state.username} onChange={this.handleChange}/>
                    Email Address
                    <input type="text" name="email" value={this.state.email} onChange={this.handleChange}/>
                    Password
                    <input type="password" name="pass_plain" value={this.state.pass_plain} onChange={this.handleChange}/>
                    Confirm Password
                    <input type="password" name="pass_conf" value={this.state.pass_conf} onChange={this.handleChange}/>
                    {this.pass_match && <p>Passwords do not match</p>}
                <input type="submit" id="submit" disabled={!this.can_submit} value="Sign Up"/>
            </form>
            </div>
        )
    }
}
ReactDOM.render(<SignupForm />, document.getElementById('content'));
</script>
{% endblock %}
